<!DOCTYPE html>
<html lang="ja">
<head>
    <title>ğŸ’—ãªãƒ¼ã“ã®pythonğŸ’—</title> 

    <div class="bg_pattern Polka_v2"></div>
   
</head>

<body>
    <div> 
        <div style="width: 500px; margin: auto;">
<p> <h1 class="heading-29">ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã§å‡ºæ¥ã‚‹ã“ã¨</h1><br></p></div>
        <link rel="stylesheet" href="style.css">
    </div>
<br>
    <div>
        <div style="width: 1000px; margin: auto;"> 
ç§ãŸã¡ã®ç­ã¯ã€ã€Œ10å¹´å‰ã®ä»Šæ—¥ã€ã©ã‚“ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒã‚ã£ãŸã®ã‹ã‚’ãƒ¡ãƒ¼ãƒ«ã§é€ä¿¡ã—ã¦ãã‚Œã‚‹ã€ã‚³ãƒ¼ãƒ‰ã‚’ä½œã‚‹ã“ã¨ã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸã€‚<br>
        </div>

    <div> 
ã€€ã€€ã€€<h2 class="heading-8">ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰</h2><br>
<div style="width: 1000px; margin: auto;"> 
    <code>
        <ol style="list-style:decimal-leading-zero outside;in-left:0;padding-left:36px;margin:0;background-color:#EEF;color:#000;">
        <li style="background-color:#EFF;">import requests</li>
        <li style="background-color:#EEF;">import feedparser</li>
        <li style="background-color:#EFF;">from datetime import datetime</li>
        <li style="background-color:#EEF;">from dateutil.relativedelta import relativedelta</li>
        <li style="background-color:#EFF;">import win32com.client</li>
        <li style="background-color:#EEF;"></li>
        <li style="background-color:#EFF;"># RSSãƒ•ã‚£ãƒ¼ãƒ‰ã®URLï¼ˆYahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ ãƒˆãƒƒãƒ—ï¼‰</li>
        <li style="background-color:#EEF;">RSS_URL = "https://news.yahoo.co.jp/rss/topics/top-picks.xml"</li>
        <li style="background-color:#EFF;"></li>
        <li style="background-color:#EEF;"># RSSãƒ•ã‚£ãƒ¼ãƒ‰ã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—</li>
        <li style="background-color:#EFF;">def get_japanese_news():</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;feed = feedparser.parse(RSS_URL)</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if feed.entries:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news_list = [</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f"{entry.published}: {entry.title}\n{entry.link}"</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for entry in feed.entries[:5]  # ä¸Šä½5ä»¶ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "\n\n".join(news_list)</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚"</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;except Exception as e:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—ã‚¨ãƒ©ãƒ¼: {e}")</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚"</li>
        <li style="background-color:#EFF;"></li>
        <li style="background-color:#EEF;"># Wayback Machineã®APIã§éå»ã®URLã‚’å–å¾—</li>
        <li style="background-color:#EFF;">def get_wayback_url(base_url, target_date):</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;wayback_api = "http://archive.org/wayback/available"</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;params = {"url": base_url, "timestamp": target_date}</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;response = requests.get(wayback_api, params=params)</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if response.status_code == 200:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data = response.json()</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;snapshots = data.get("archived_snapshots", {})</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;closest = snapshots.get("closest", {})</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if closest:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return closest["url"]</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return None</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Wayback Machine APIã‚¨ãƒ©ãƒ¼: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ {response.status_code}")</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return None</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;except Exception as e:</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Wayback Machineãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {e}")</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return None</li>
        <li style="background-color:#EEF;"></li>
        <li style="background-color:#EFF;"># Wayback Machineã®URLã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ã‚¹æƒ…å ±ã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ—</li>
        <li style="background-color:#EEF;">def scrape_news_from_wayback(wayback_url):</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# å®Ÿéš›ã«ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ—ã™ã‚‹å‡¦ç†ã‚’ã“ã“ã«è¿½åŠ </li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# ç¾æ™‚ç‚¹ã§ã¯ã‚µãƒ³ãƒ—ãƒ«ã¨ã—ã¦ãƒ€ãƒŸãƒ¼ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¿”ã™</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;return f"éå»ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼ˆ{wayback_url}ï¼‰ã‚’å–å¾—ã—ã¾ã—ãŸã€‚"</li>
        <li style="background-color:#EEF;"></li>
        <li style="background-color:#EFF;"># Outlookã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒ¼ãƒ«é€ä¿¡é–¢æ•°</li>
        <li style="background-color:#EEF;">def send_outlook_email(subject, body, to_email):</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;try:</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outlook = win32com.client.Dispatch("Outlook.Application")</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail = outlook.CreateItem(0)  # 0ã¯ãƒ¡ãƒ¼ãƒ«ã‚¢ã‚¤ãƒ†ãƒ ã‚’ç¤ºã™</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail.To = to_email</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail.Subject = subject</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail.Body = body</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail.Send()</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print("OutlookçµŒç”±ã§ãƒ¡ãƒ¼ãƒ«ãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚")</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;except Exception as e:</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print(f"Outlookãƒ¡ãƒ¼ãƒ«é€ä¿¡ã‚¨ãƒ©ãƒ¼: {e}")</li>
        <li style="background-color:#EFF;"></li>
        <li style="background-color:#EEF;"># ãƒ¡ã‚¤ãƒ³å‡¦ç†</li>
        <li style="background-color:#EFF;">def main():</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# 10å¹´å‰ã®æ—¥ä»˜ã‚’æ­£ç¢ºã«è¨ˆç®—</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;ten_years_ago = datetime.now() - relativedelta(years=10)</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;today = ten_years_ago.strftime("%Yå¹´%mæœˆ%dæ—¥")</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# Wayback Machineã§10å¹´å‰ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–URLã‚’å–å¾—</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;base_url = "https://news.yahoo.co.jp/topics"</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;target_date = ten_years_ago.strftime("%Y%m%d")  # 10å¹´å‰ã®æ—¥ä»˜ã‚’YYYYMMDDå½¢å¼ã§å–å¾—</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;# Wayback Machineã‹ã‚‰10å¹´å‰ã®Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–URLã‚’å–å¾—</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;wayback_url = get_wayback_url(base_url, target_date)</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;if wayback_url:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news = scrape_news_from_wayback(wayback_url)</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;else:</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;news = "10å¹´å‰ã®ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"</li>
        <li style="background-color:#EEF;"></li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# ãƒ¡ãƒ¼ãƒ«ã®ä»¶åã¨æœ¬æ–‡ã‚’è¨­å®š</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;subject = f"10å¹´å‰ã®ä»Šæ—¥ ({today}) ã®æ—¥æœ¬ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹"</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;body = f"10å¹´å‰ã®{today}ã®æœ€æ–°æ—¥æœ¬ãƒ‹ãƒ¥ãƒ¼ã‚¹:\n\n{news}"</li>
        <li style="background-color:#EEF;"></li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;# é€ä¿¡å…ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŒ‡å®š</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;to_email = "r202401795pu@jindai.jp"</li>
        <li style="background-color:#EFF;">&nbsp;&nbsp;&nbsp;&nbsp;send_outlook_email(subject, body, to_email)</li>
        <li style="background-color:#EEF;"></li>
        <li style="background-color:#EFF;">if __name__ == "__main__":</li>
        <li style="background-color:#EEF;">&nbsp;&nbsp;&nbsp;&nbsp;main()</li>
        <li style="background-color:#EFF;"></li>
        </ol></code>

    <br>
ã€€ã€€ã€€ã€€ã€€ã€€ <a href="./python/mail.py">>ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰</a><br>
   </div>
   <div>
ã€€ã€€ã€€ <h2 class="heading-8">è§£èª¬</h2><br>
ã€€ã€€ã€€ChatGPTã‚’å‚è€ƒã«ã—ã¦ä½œæˆã—ãŸã€‚ãƒ¡ãƒ¼ãƒ«ã®å†…å®¹ãŒè‹±èªã§é€ã‚‰ã‚Œã¦ãã¦ã—ã¾ã£ãŸã‚Šã€ãã‚‚ãã‚‚ã€Œãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€ã¨ã„ã†ãƒ¡ãƒ¼ãƒ«ã—ã‹é€ã‚‰ã‚Œã¦ã“ãªã‹ã£ãŸã‚Šã—ãŸã®ã§ã€<br>
ã€€ã€€ã€€ä½•å›ã‚‚æ”¹å–„ã‚’é‡ã­ãŸã€‚ã—ã‹ã—ã€æœ€çµ‚çš„ã«ã¯10å¹´å‰ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ã‚µã‚¤ãƒˆã«é£›ã¶ã“ã¨ãŒå‡ºæ¥ã¦ã‚‚ã€ãã®è©³ç´°ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã§è¦‹ã‚‰ã‚Œãªã„å½¢ã¨ãªã£ã¦ã—ã¾ã£ãŸã€‚ç§ã«ã¯ã“ã‚ŒãŒé™ç•Œâ€¦ğŸ˜­ã™ã¿ã¾ã›ã‚“ğŸ’§
ã€€ã€€ã€€ã€€ã€€ã€€
    <br>
    <br>
    </div>